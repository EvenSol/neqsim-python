#!/bin/sh
# Git pre-commit hook that ensures repository pre-commit checks run automatically.
# If Poetry is available we prefer it to ensure hooks execute in the managed virtualenv.

set -eu

run_pre_commit() {
    if command -v poetry >/dev/null 2>&1; then
        exec poetry run pre-commit run --hook-stage pre-commit "$@"
    elif command -v pre-commit >/dev/null 2>&1; then
        exec pre-commit run --hook-stage pre-commit "$@"
    else
        cat >&2 <<'MSG'
Error: pre-commit is not installed.
Install it with "pip install pre-commit" or "poetry add --group dev pre-commit".
MSG
        exit 1
    fi
}

run_pre_commit "$@"
